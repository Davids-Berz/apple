<!DOCTYPE html>
<html lang="en" xmlns="http://www.thymeleaf.org">
  <head th:replace="layout :: head"></head>
  <body>
    <div th:replace="layout :: nav"></div>
    <div container py-4>
      <div class="card bg-light">
        <div class="card-header border-danger-subtle border-bottom" th:text="${titulo}"></div>
        <div class="card-body">
          <h4 class="card-title d-flex justify-content-end">
            <a class="btn btn-success btn-xs mx-2" th:href="@{'/factura/ver/' + ${factura.id}(format=xlsx)}">Excel</a>
                <a class="btn btn-danger btn-xs " th:href="@{'/factura/ver/' + ${factura.id}(format=pdf)}">PDF</a>
          </h4>
          <ul class="list-group my-2">
            <li
              th:text="'Datos del Cliente'"
              class="list-group-item list-group-item-primary"
            ></li>
            <li class="list-group-item" th:text="'Cliente: '+${factura.cliente}"></li>
            <li class="list-group-item" th:text="'Correo: '+${factura.cliente.email}"></li>
          </ul>
          <ul class="list-group">
            <li
              th:text="'Datos de la factura'"
              class="list-group-item list-group-item-success"
            ></li>
            <li
              class="list-group-item"
              th:text="'Folio: ' + ${factura.id}"
            ></li>
            <li
              class="list-group-item"
              th:text="'Descripcion: ' +${factura.descripcion}"
            ></li>
            <li
              class="list-group-item"
              th:text="'Fecha: ' +${factura.createAt}"
            ></li>
          </ul>

          <div class="alert alert-info py-4" th:if="${#lists.isEmpty(factura.items)}" th:text="'No hay lineas para la factura' + ${factura.descr}"></div>

          <table  th:if="${not #lists.isEmpty(factura.items)}" class="table table-striped table-hover table-bordered my-3">
            <thead>
                <tr>
                    <th>Producto</th>
                    <th>Precio</th>
                    <th>Cantidad</th>
                    <th>Total</th>
                </tr>
                <tbody>
                    <tr th:each="linea : ${factura.items}">
                        <td th:text="${linea.producto.nombre}"></td>
                        <td th:text="${linea.producto.precio}"></td>
                        <td th:text="${linea.cantidad}"></td>
                        <td th:text="${linea.calcularImporte()}"></td>
                    </tr>
                </tbody>
            </thead>
          </table>
          <h5 class="text-end">Gran total <span class="badge text-bg-secondary" th:text="${factura.total}"></span></h5>
          <div class="card border-info my-2" style="max-width: 20rem;">
            <div class="card-header">Observaciones</div>
              <div class="card-body">
                <p th:text="${factura.observacion}" class="card-text" th:if="${not #strings.isEmpty(factura.observacion)}"></p>
                <h4 th:text="'No tiene observacion'" th:if="${#strings.isEmpty(factura.observacion)}"></h4>
              </div>
          </div>
        </div>
      </div>
    </div>
    <div class="d-flex m-4">
      <a
      th:href="@{'/ver/' + ${factura.cliente.id}}"
      class="btn btn-secondary"
      >volver</a>
    </div>
    <div th:replace="layout :: footer"></div>
  </body>
</html>
